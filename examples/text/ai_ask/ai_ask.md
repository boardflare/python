# AI_ASK

## Overview

This function interacts with an AI model to generate text-based responses based on a given prompt. It can optionally incorporate data provided as a 2D list into the prompt for more context-specific analysis or generation.

## Usage
To use the `AI_ASK` function in Excel, enter it as a formula in a cell, specifying your prompt and any optional arguments as needed:

```excel
=AI_ASK(prompt, [data], [temperature], [max_tokens], [model])
```
Replace each parameter with your desired value. The function returns a text response generated by the AI model.

## Parameters
| Parameter      | Type     | Required | Description                                                                                                 | Default         |
|---------------|----------|----------|-------------------------------------------------------------------------------------------------------------|-----------------|
| prompt        | string   | Yes      | The question, task, or instruction for the AI.                                                              |                 |
| data          | 2D list  | No       | Data from an Excel range to be included in the context sent to the AI.                                      | None            |
| temperature   | float    | No       | Controls the randomness/creativity of the response (0.0 to 2.0). Higher values mean more creative.          | 0.5             |
| max_tokens    | int      | No       | Maximum number of tokens (words/subwords) the AI should generate in its response.                           | 250             |
| model         | string   | No       | The specific AI model ID to use for the request (e.g., 'mistral-small', 'mistral-large').                   | mistral-small   |

## Return Value
| Return Value | Type   | Description                                  |
|--------------|--------|----------------------------------------------|
| Response     | string | The text response generated by the AI model. |

## Limitations
- The quality of the response depends on the clarity of the prompt and the data provided.
- Large data ranges may exceed model context limits and result in truncated or incomplete responses.
- The function requires an internet connection to access the AI model.
- Model availability and output may vary depending on the provider or API changes.
- Sensitive or confidential data should not be sent to external AI services.

## Benefits
**Can this be done natively in Excel?**
While Excel offers built-in functions for calculations and data analysis, it does not natively support advanced natural language generation, summarization, or business writing tasks powered by AI models. Manual analysis or writing is time-consuming and may lack consistency.

**Why use this Python function?**
- Automates text analysis, summarization, and business writing directly in Excel.
- Saves time and improves consistency in reporting and communication.
- Enables dynamic, context-aware responses using your own data.
- More flexible and powerful than manual or native Excel approaches for text generation and analysis.

## Examples

### Employee Engagement Summary
Ask for a summary of employee engagement survey results.

**Sample Input Data (Range `A1:B5`):**

| Question            | Score |
|---------------------|-------|
| Team collaboration  | 4.5   |
| Workload            | 3.2   |
| Career advancement  | 3.0   |
| Management support  | 4.0   |

```excel
=AI_ASK("Summarize the key findings from the employee engagement survey:", A1:B5)
```
**Sample Output:**
"The survey indicates high satisfaction with team collaboration but highlights concerns about workload and career advancement opportunities."

### Quarterly Sales Analysis
Analyze quarterly sales data and provide insights.

**Sample Input Data (Range `A1:E4`):**

| Region   | Q1   | Q2   | Q3   | Q4   |
|----------|------|------|------|------|
| North    | 120  | 135  | 150  | 160  |
| South    | 100  | 110  | 120  | 130  |
| Central  | 90   | 95   | 100  | 105  |

```excel
=AI_ASK("Provide a brief analysis of the quarterly sales performance:", A1:E4)
```
**Sample Output:**
"Sales increased steadily across all regions, with the North region showing the highest growth in Q4."

### Summarize Incident Report
Summarize a block of operational incident text provided in a cell.

**Sample Input Text (Cell `A1`):**
"On April 10th, a system outage affected order processing for 2 hours. The IT team resolved the issue by updating server configurations. No data loss occurred."

```excel
=AI_ASK("Summarize the following incident report in one sentence:", A1)
```
**Sample Output:**
"A brief system outage on April 10th was quickly resolved by IT with no data loss."

### Draft a Customer Follow-up Email
Generate a professional follow-up email based on a prompt.
```excel
=AI_ASK("Draft a follow-up email to a client after a successful product demo.")
```
**Sample Output:**
"Thank you for attending our product demonstration. Please let us know if you have any questions or would like to discuss next steps. We look forward to working with you."