<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Logout</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script type="module">
        import { PublicClientApplication } from "https://cdn.jsdelivr.net/npm/@azure/msal-browser@3.17.0/+esm";

        const msalConfig = {
            auth: {
                clientId: '7fc35253-f44d-4c02-aea9-9b0b7a0a4b61',
                authority: "https://login.microsoftonline.com/common",
                redirectUri: window.location.origin + window.location.pathname
            },
            cache: {
                cacheLocation: 'localStorage'
            }
        };

        Office.onReady(async function() {
            try {
                // Clear MSAL and app tokens from localStorage and sessionStorage
                localStorage.clear();
                sessionStorage.clear();
            } catch (e) {
                // Ignore errors
            }

            // Initialize MSAL and perform logout
            const pca = new PublicClientApplication(msalConfig);
            await pca.initialize();
            // Get the current account (if any)
            const accounts = pca.getAllAccounts();
            const currentAccount = accounts && accounts.length > 0 ? accounts[0] : undefined;
            // Use logoutRedirect with account for proper sign-out
            await pca.logoutRedirect({
                account: currentAccount,
                postLogoutRedirectUri: window.location.origin + window.location.pathname
            });
        });
    </script>
    <style>
        body { font-family: sans-serif; text-align: center; margin-top: 40px; }
    </style>
</head>
<body>
    <p id="logout-message">Signing you out of the add-in...</p>
</body>
</html>
